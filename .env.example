# ============================================================
# Regolancer Orchestrator — .env.example
# ============================================================
# This file documents all environment variables used by
# regolancer-orchestrator.
#
# Values here reflect the recommended DEFAULTS.
# Copy to .env and adjust only what you understand.
# ============================================================


# ------------------------------------------------------------
# DRY-RUN MODE
# ------------------------------------------------------------
# When TRUE, regolancer is NOT executed.
# The orchestrator will simulate cycles and logging only.
#
# Recommended:
# - TRUE  → testing / debugging
# - FALSE → production
DRY_RUN=false


# ------------------------------------------------------------
# LNDg (Lightning Node Dashboard)
# ------------------------------------------------------------
# Base URL where LNDg API is accessible.
# Usually runs on localhost.
LNDG_BASE_URL=http://localhost:8889

# LNDg authentication credentials.
# REQUIRED for the orchestrator to fetch channels.
LNDG_USER=
LNDG_PASS=

# ------------------------------------------------------------
# LOS → LNDg AUTO SYNC
# ------------------------------------------------------------
# When TRUE, the orchestrator will execute
# sync_los_to_lndg.sh every 60 seconds.
#
# This is intended to synchronize channel settings
# or policies between LightningOS (LOS) and LNDg.
#
# WARNING:
# - The script must exist and be executable.
# - Ensure the script is idempotent (safe to run repeatedly).
# - If the script takes longer than 60s, executions may overlap.
#
# Recommended:
# - FALSE → default / disabled
# - TRUE  → enable automatic synchronization
SYNC_LOS_TO_LNDG=FALSE

# ------------------------------------------------------------
# TELEGRAM NOTIFICATIONS
# ------------------------------------------------------------
# Telegram bot token.
# Required for rebalance notifications and report error alerts.
TELEGRAM_TOKEN=

# Telegram chat ID (user or group).
TELEGRAM_CHAT_ID=

# ------------------------------------------------------------
# TELEGRAM — REBALANCE NOTIFICATIONS
# ------------------------------------------------------------
# Control Telegram notifications for successful rebalances.
#
# Each source can be enabled/disabled independently.
#
# Recommended:
# - TRUE  → production (monitoring enabled)
# - FALSE → silent mode

# Regolancer-Orchestrator rebalances (success-rebal.csv)
SEND_REBALANCE_MSG_REGO_ORCH=TRUE

# LNDg rebalances (API /api/rebalancer/?status=2)
SEND_REBALANCE_MSG_LNDG=TRUE

# LightningOS rebalances (API /api/rebalance/history)
SEND_REBALANCE_MSG_LOS=TRUE

# Enable daily report execution at 23:59.
# Report execution state is persisted to disk.
#
# Recommended: TRUE
ENABLE_DAILY_REPORT=TRUE


# ------------------------------------------------------------
# REGOLANCER CONFIGURATION
# ------------------------------------------------------------
# When TRUE, prints the generated regolancer JSON config
# for each rebalance attempt.
#
# WARNING: Very verbose, debug only.
LOG_TEMPLATE_CONFIG=FALSE


# ------------------------------------------------------------
# ORCHESTRATOR — AMOUNT STRATEGY
# ------------------------------------------------------------
# Initial rebalance amount (sats).
AMOUNT_INITIAL=15000

# Percentage increase applied to AMOUNT_INITIAL
# every AMOUNT_EVERY_ROUNDS cycles.
#
# Example:
# 200 = +200% (3x the original amount)
AMOUNT_INCREASE_PERCENT=200

# Number of cycles before increasing the amount.
AMOUNT_EVERY_ROUNDS=1

# Maximum number of increases before resetting
# back to AMOUNT_INITIAL.
AMOUNT_MAX_INCREASES=2


# ------------------------------------------------------------
# ORCHESTRATOR — EXECUTION CONTROL
# ------------------------------------------------------------
# When TRUE, workers run indefinitely.
# Should almost always be TRUE in production.
RUN_FOREVER=true

# Sleep time (seconds) between cycles of each worker.
#
# Increasing this reduces CPU usage and system load.
SLEEP_SECONDS=15

# Number of independent workers running in parallel.
#
# IMPORTANT:
# - More workers = more CPU usage
# - Start small (1–2) and monitor CPU pressure
MAX_WORKERS=2

# Maximum duration (in seconds) allowed for a single
# worker cycle.
#
# If exceeded, the cycle is aborted and restarted
# to avoid acting on stale channel data.
#
# Example:
# 300 = 5 minutes
MAX_CYCLE_SECONDS=300

# ------------------------------------------------------------
# REGOLANCER — LIVE OUTPUT
# ------------------------------------------------------------
# When TRUE, prints regolancer stdout/stderr in real time.
#
# WARNING:
# - High CPU usage
# - High context switching
# - Heavy journalctl pollution
# - Should NEVER be enabled for long-running production
#
# Recommended:
# - FALSE → production (low overhead, cool system)
# - TRUE  → short debugging sessions only
REGOLANCER_LIVE_LOGS=FALSE

# ------------------------------------------------------------
# ORCHESTRATOR — LOGGING & PERFORMANCE
# ------------------------------------------------------------
# Enable writing auxiliary log files to disk.
# Currently reserved for future extensions.
#
# Recommended: FALSE (lower disk usage)
ENABLE_FILE_LOGS=FALSE

# Randomize the order of channel pairs each cycle.
#
# When TRUE:
# - Avoids starvation when cycles time out
# - Ensures fair coverage of all pairs over time
#
# Recommended:
# - FALSE → deterministic behavior
# - TRUE  → time-limited cycles with many pairs
RANDOMIZE_PAIRS=TRUE

# Enable verbose operational logs for each pair:
# e.g. SRC → TGT, amounts, thresholds.
#
# WARNING:
# - Generates many logs
# - Increases CPU usage
# - Pollutes journalctl
#
# Recommended:
# - FALSE → production (quiet & cool)
# - TRUE  → debugging only
LOG_OPERATIONAL=TRUE
